{
    "name": "no-train-test",
    "description": "Index vector search which does not use an algorithm that requires training.",
    "default": true,
    "schedule": [
       {{ benchmark.collect(parts="common/index-only-schedule.json") }},
       {{ benchmark.collect(parts="common/force-merge-schedule.json") }},
       {{ benchmark.collect(parts="common/search-only-schedule.json") }}
    ]
},
{
    "name": "no-train-test-index-only",
    "description": "Perform only indexing operation for vector search",
    "default": false,
    "schedule": [
       {{ benchmark.collect(parts="common/index-only-schedule.json") }}
    ]
},
{
    "name": "no-train-test-index-with-merge",
    "description": "Perform only indexing operation for vector search",
    "default": false,
    "schedule": [
       {{ benchmark.collect(parts="common/index-only-schedule.json") }},
       {{ benchmark.collect(parts="common/force-merge-schedule.json") }}
    ]
},
{
    "name": "search-only",
    "default": false,
    "description": "Perform only vector search on previously indexed cluster.",
    "schedule": [
       {{ benchmark.collect(parts="common/search-only-schedule.json") }}
    ]
},
{
    "name": "force-merge-index",
    "default": false,
    "description": "Force merge vector search index to improve search performance",
    "schedule": [
       {{ benchmark.collect(parts="common/force-merge-schedule.json") }}
    ]
},
{
    "name": "no-train-test-aoss",
    "description": "Index vector search which does not use an algorithm that requires training.",
    "default": false,
    "schedule": [
       {{ benchmark.collect(parts="aoss/index-only-schedule.json") }},
       {{ benchmark.collect(parts="aoss/search-only-schedule.json") }}
    ]
},
{
    "name": "train-test",
    "description": "Index vector search that requires training.",
    "default": false,
    "schedule": [
        {{ benchmark.collect(parts="common/train-index-only-schedule.json") }},
        {{ benchmark.collect(parts="common/train-model-schedule.json") }},
        {{ benchmark.collect(parts="common/force-merge-schedule.json") }},
        {{ benchmark.collect(parts="common/search-only-schedule.json") }}
    ]
},
{
  "name": "restore-from-snapshot",
  "description": "Index vector search which does not use an algorithm that requires training.",
  "default": false,
  "schedule": [
    {
      "name": "register-snapshot-repository",
      "operation": {
        "operation-type": "create-snapshot-repository",
        "repository": {{ snapshot_repo_name | default('test-snapshot-repo') | tojson }},
        "body": {
          "type": "s3",
          "settings": {
            "bucket": {{ snapshot_bucket_name | default('test-snapshot-bucket') | tojson }},
            "region": {{ snapshot_region | default('us-east-1') | tojson }},
            "base_path": {{ snapshot_base_path | default('test-base-path') | tojson }}
          }
        }
      }
    },
    {
      "name": "restore-from-snapshot",
      "operation": {
        "operation-type": "restore-snapshot",
        "repository": {{ snapshot_repo_name | default('test-snapshot-repo') | tojson }},
        "snapshot": {{ snapshot_name | default('test-snapshot') | tojson }},
        "body": {
          "index_settings": {
            "index.number_of_replicas": {{ number_of_replicas | default(0) }}
          }
        },
        "wait-for-completion": false
      }
    },
    {
      "name": "wait-for-snapshot-recovery",
      "operation": {
        "operation-type": "wait-for-recovery",
        "index": "target_index"
      }
    },
    {{ benchmark.collect(parts="common/index-only-schedule.json") }},
    {{ benchmark.collect(parts="common/force-merge-schedule.json") }},
    {{ benchmark.collect(parts="common/search-only-schedule.json") }}
  ]
},
{
  
    "name": "gpu-based-vector-test",
    "description": "Perform vectorsearch benchmark on gpu based vector",
    "default": false,
    "schedule": [
      {
        "name": "register-snapshot-repository",
        "operation": {
          "operation-type": "create-snapshot-repository",
          "repository": {{ snapshot_repo_name | default('test-snapshot-repo') | tojson }},
          "body": {
            "type": "s3",
            "settings": {
              "bucket": {{ snapshot_bucket_name | default('test-snapshot-bucket') | tojson }},
              "region": {{ snapshot_region | default('us-east-1') | tojson }},
              "base_path": {{ snapshot_base_path | default('test-base-path') | tojson }}
            }
          }
        }
      },
      {
        "name": "apply-gpu-vector-settings",
        "operation": {
          "operation-type": "put-settings",
          "body": {
            "persistent" : {
                "knn.remote_index_build.vector_repo" : {{ snapshot_repo_name | default('test-snapshot-repo') | tojson }},
                "knn.feature.remote_index_build.enabled" : true,
                "knn.remote_index_build.client.endpoint" : {{ client_endpoint | default('test-endpoint') | tojson }},
            }
          }
        }
      },
      {{ benchmark.collect(parts="common/index-only-schedule.json") }},
      {{ benchmark.collect(parts="common/force-merge-schedule.json") }},
      {{ benchmark.collect(parts="common/search-only-schedule.json") }}
    ]
}
